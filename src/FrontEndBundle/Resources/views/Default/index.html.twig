<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart</title>


    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/dataTables.css') }}">
    <link rel="stylesheet" href="{{ asset('css/ardi.css') }}">

    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
</head>

{% block title %}Company List{% endblock %}

<body>
<h1>Welcome, user192381</h1>
<div class="itemlist-table">
    <h2><strong>Item List</strong></h2>
    <table id="dataTable-item-list"  class="custom-item-table">
        <thead>
        <tr>
            <th>Name</th>
            <th>Quantity</th>
        </tr>
        </thead>
    </table>
</div>

<div class="information-tab">

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" role="tablist">
        <li role="presentation" class="active"><a href="#createHistory" aria-controls="createHistory" role="tab" data-toggle="tab">Create</a></li>
        <li role="presentation"><a href="#viewHistory" aria-controls="viewHistory" role="tab" data-toggle="tab">View</a></li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
        <div role="tabpanel" class="tab-pane fade in active" id="createHistory">
            <form class="form-horizontal create-form">
                <div class="form-group">
                    <label for="inputEmail3-id" class="col-sm-2 control-label">Item Name</label>
                    <div class="col-sm-10">
                        <select id="cboItem" name="cboItem">
                            {% for item in items %}
                                <option value="{{ item.id }}">{{ item.name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Quantity</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="input2" placeholder="">
                    </div>
                </div>
                <div class="form-group">
                    <label for="inputEmail3" class="col-sm-2 control-label">Incoming</label>
                    <div class="col-sm-10">
                        <label class="radio-inline">
                            <input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="option1"> Yes
                        </label>
                        <label class="radio-inline">
                            <input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="option2"> No
                        </label>
                    </div>
                </div>
                <button class="submit">Submit</button>
            </form>
        </div>
        <div role="tabpanel" class="tab-pane fade" id="viewHistory">
            <table id="dataTable-list-stock" class="custom-item-table">
                <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Quantity</th>
                    <th>Stock Transaction</th>
                </tr>
                </thead>
            </table>
        </div>
    </div>

</div>
</body>

<script src="{{ asset("js/jquery-1.12.min.js") }}"></script>
<script src="{{ asset("js/bootstrap.min.js") }}"></script>
<script src="{{ asset("js/dataTables.min.js") }}"></script>

<script>
    $(document).ready(function(){
        $('#dataTable').DataTable({
            "sDom": 't<"bottom"i><"display-block"p>'
        });


        $('#view-table').DataTable({
            "sDom": 't<"bottom"i><"display-block"p>'
        });

            var eg = $('#dataTable-list-stock').dataTable({
                bPaginate: false,
                serverSide: true,
                processing: true,
                ajax: {
                    url: "/api/stock_transaction/list",
                    type: "GET"
                },
                columns: [
                    {
                        data: function (data) {
                            return data.item.id;
                        }
                    },
                    {
                        data: function(data) {
                            return data.item.name;
                        }
                    },
                    {
                        data: function(data) {
                            return data.quantity;
                        }
                    },
                    {
                        data: function(data) {
                            return data.item.stock_transaction[0].quantity;
                        }
                    }
                ]
            });

        var dg = $('#dataTable-item-list').dataTable({
            serverSide: true,
            processing: true,
            bPaginate: false,
            ajax: {
                url: "/api/items/list",
                type: "GET"
            },
            columns: [
                {
                    data: function (data) {
                        return data.name;
                    }
                },
                {
                    data: function(data) {
                        return data.quantity;
                    }
                }
            ]
        });

        $(".submit").click(function () {
            if(document.getElementById('inlineRadio1').checked) {
                var type = 0;
            }else if(document.getElementById('inlineRadio2').checked) {
                var type = 1;
            }

            $.ajax({
                type:'POST',
                url: '/api/stock_transaction',
                data: {'item_id': $('#input1').val(),'incoming_stock': type, 'quantity': $('#input2').val()},
                success: function(response) {
                    console.log(response);
                }
            });
        });
    });
</script>
</html>